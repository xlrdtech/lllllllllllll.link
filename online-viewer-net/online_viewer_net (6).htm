<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Selfown OS</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Lucide Icons (Vanilla) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Custom Scrollbar Hiding */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Disable touch highlights on mobile */
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        body {
            background-color: #000;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useRef, useEffect } = React;

        // --- ICON SYSTEM ---
        // Helper to convert vanilla Lucide icons to React Components on the fly
        const IconWrapper = ({ name, size = 24, color = "currentColor", className = "", ...props }) => {
            const iconName = name; // Lucide vanilla uses camelCase keys usually
            
            // We need to render the SVG contents manually since we are using vanilla lucide in React
            // Fortunately, lucide.icons contains the definitions
            const iconDef = window.lucide.icons[iconName];
            
            if (!iconDef) return null;

            // iconDef is [tag, attrs, children] in some versions, or an object in others.
            // In the latest UMD, lucide.icons is an object where keys are names and values are the SVG path data/structure.
            // Let's use a simpler approach: Render an <i data-lucide={name}></i> and run lucide.createIcons() on effect.
            // However, that's bad for React diffing.
            
            // Robust Approach: Use the SVG string generation provided by Lucide
            // But we need to parse it into React elements or use dangerouslySetInnerHTML.
            // Ideally, we'd use lucide-react UMD, but it's unstable. 
            // We will use dangerouslySetInnerHTML on an SVG element for maximum compatibility with the single-file constraint.
            
            const svgString = iconDef.toSvg({
                'width': size,
                'height': size,
                'class': className,
                'stroke': color === 'currentColor' ? 'currentColor' : undefined, // Let CSS handle color if class sets it
                'stroke-width': 2,
                ...props
            });

            return (
                <span 
                    className={`flex items-center justify-center ${color !== 'currentColor' && !color.startsWith('text-') ? '' : color}`} 
                    style={{ color: color.startsWith('text-') ? undefined : color }}
                    dangerouslySetInnerHTML={{ __html: svgString }} 
                />
            );
        };

        // Map PascalCase names used in code to camelCase names in Lucide library
        const Settings = (p) => <IconWrapper name="settings" {...p} />;
        const ChevronRight = (p) => <IconWrapper name="chevron-right" {...p} />;
        const Moon = (p) => <IconWrapper name="moon" {...p} />;
        const Sun = (p) => <IconWrapper name="sun" {...p} />;
        const Search = (p) => <IconWrapper name="search" {...p} />;
        const Mail = (p) => <IconWrapper name="mail" {...p} />;
        const MessageSquare = (p) => <IconWrapper name="message-square" {...p} />;
        const Keypad = (p) => <IconWrapper name="grip-horizontal" {...p} />; // approximation
        const Users = (p) => <IconWrapper name="users" {...p} />;
        const MonitorSmartphone = (p) => <IconWrapper name="monitor-smartphone" {...p} />;
        const Phone = (p) => <IconWrapper name="phone" {...p} />;
        const Clock = (p) => <IconWrapper name="clock" {...p} />;
        const Wifi = (p) => <IconWrapper name="wifi" {...p} />;
        const Zap = (p) => <IconWrapper name="zap" {...p} />;
        const X = (p) => <IconWrapper name="x" {...p} />;
        const Volume2 = (p) => <IconWrapper name="volume-2" {...p} />;
        const Mic = (p) => <IconWrapper name="mic" {...p} />;
        const Video = (p) => <IconWrapper name="video" {...p} />;
        const PhoneOff = (p) => <IconWrapper name="phone-off" {...p} />;
        const Activity = (p) => <IconWrapper name="activity" {...p} />;
        const Lock = (p) => <IconWrapper name="lock" {...p} />;
        const Sliders = (p) => <IconWrapper name="sliders" {...p} />;
        const FileText = (p) => <IconWrapper name="file-text" {...p} />;
        const Camera = (p) => <IconWrapper name="camera" {...p} />;
        const Gamepad2 = (p) => <IconWrapper name="gamepad-2" {...p} />;
        const Send = (p) => <IconWrapper name="send" {...p} />;
        const Hash = (p) => <IconWrapper name="hash" {...p} />;
        const Briefcase = (p) => <IconWrapper name="briefcase" {...p} />;
        const Globe = (p) => <IconWrapper name="globe" {...p} />;
        const PhoneIncoming = (p) => <IconWrapper name="phone-incoming" {...p} />;
        const PhoneOutgoing = (p) => <IconWrapper name="phone-outgoing" {...p} />;
        const PhoneMissed = (p) => <IconWrapper name="phone-missed" {...p} />;
        const User = (p) => <IconWrapper name="user" {...p} />;
        const Folder = (p) => <IconWrapper name="folder" {...p} />;
        const Power = (p) => <IconWrapper name="power" {...p} />;
        const Fingerprint = (p) => <IconWrapper name="fingerprint" {...p} />;
        const Bluetooth = (p) => <IconWrapper name="bluetooth" {...p} />;
        const Bell = (p) => <IconWrapper name="bell" {...p} />;
        const Battery = (p) => <IconWrapper name="battery" {...p} />;
        const SunDim = (p) => <IconWrapper name="sun-dim" {...p} />;
        const Heart = (p) => <IconWrapper name="heart" {...p} />;
        const CheckCircle = (p) => <IconWrapper name="check-circle" {...p} />;
        const XCircle = (p) => <IconWrapper name="x-circle" {...p} />;
        const RefreshCw = (p) => <IconWrapper name="refresh-cw" {...p} />;
        const Plus = (p) => <IconWrapper name="plus" {...p} />;
        const Loader = (p) => <IconWrapper name="loader" {...p} />;
        const BatteryCharging = (p) => <IconWrapper name="battery-charging" {...p} />;
        const Layers = (p) => <IconWrapper name="layers" {...p} />;
        const Command = (p) => <IconWrapper name="command" {...p} />;


        // --- UTILS & STYLES ---

        const GLASS_PANEL = 'bg-white/5 backdrop-blur-3xl border border-white/10 shadow-[0_8px_32px_0_rgba(0,0,0,0.37)]';
        const NEON_TEXT = 'text-transparent bg-clip-text bg-gradient-to-r from-blue-200 via-cyan-200 to-white drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]';

        const LiquidText = ({ children, className = "" }) => (
            <h1 className={`text-3xl font-black tracking-widest uppercase ${NEON_TEXT} ${className}`}>
                {children}
            </h1>
        );

        const LiquidContainer = ({ children, className = "" }) => (
            <div className={`rounded-[2rem] overflow-hidden relative ${GLASS_PANEL} ${className}`}>
                <div className="absolute top-0 left-0 right-0 h-1/3 bg-gradient-to-b from-white/5 to-transparent pointer-events-none" />
                {children}
            </div>
        );

        // --- SHARED COMPONENTS ---

        const SegmentedControl = ({ options, selectedOption, onSelect }) => (
        <div className="p-1 flex w-full rounded-2xl bg-black/20 backdrop-blur-xl border border-white/5 shadow-inner">
            {options.map((option) => (
            <button
                key={option.id}
                className={`flex-1 py-2.5 rounded-xl text-xs font-bold tracking-widest uppercase transition-all duration-500 relative overflow-hidden
                ${selectedOption === option.id ? 'text-white shadow-lg' : 'text-white/40 hover:text-white/70'}
                `}
                onClick={() => onSelect(option.id)}
            >
                {selectedOption === option.id && (
                    <div className="absolute inset-0 bg-white/10 backdrop-blur-md border border-white/20 rounded-xl" />
                )}
                <span className="relative z-10">{option.label}</span>
            </button>
            ))}
        </div>
        );

        // --- 1. BEEPER PANEL ---

        const BeeperScreen = () => {
            const [selectedTab, setSelectedTab] = useState('unified');

            const mockUnified = [
                { id: 1, name: 'Agent Wren', message: 'Target acquired. Uploading visuals now.', time: 'NOW', icon: Zap, color: 'text-cyan-300', unread: true, network: 'iMessage' },
                { id: 2, name: 'Sarah (Design)', message: 'New mockups are live on Figma.', time: '2m', icon: Camera, color: 'text-pink-300', unread: true, network: 'Instagram' },
                { id: 3, name: 'Dev Channel', message: 'Build failed: Error in module core.x', time: '15m', icon: Gamepad2, color: 'text-indigo-300', unread: false, network: 'Discord' },
                { id: 4, name: 'Elon', message: 'Thinking about that concept you sent.', time: '1h', icon: X, color: 'text-gray-300', unread: false, network: 'X (Twitter)' },
            ];

            const mockBridges = [
                { id: 'imessage', name: 'iMessage (Go)', status: 'online', latency: '12ms', version: 'v0.13.0' },
                { id: 'whatsapp', name: 'WhatsApp', status: 'online', latency: '45ms', version: 'v0.10.4' },
                { id: 'signal', name: 'Signal', status: 'syncing', latency: '--', version: 'v0.6.1' },
                { id: 'discord', name: 'Discord', status: 'offline', latency: 'ERR', version: 'v0.5.0' },
            ];

            const getStatusIcon = (status) => {
                switch(status) {
                    case 'online': return <CheckCircle size={16} className="text-green-400" />;
                    case 'syncing': return <RefreshCw size={16} className="text-yellow-400 animate-spin" />;
                    case 'offline': return <XCircle size={16} className="text-red-500" />;
                    default: return <Activity size={16} className="text-gray-500" />;
                }
            };

            return (
                <div className="h-full flex flex-col animate-in fade-in duration-500 w-full">
                    <LiquidText className="text-center mb-8">Beeper</LiquidText>
                    
                    <div className="mb-6">
                        <SegmentedControl options={[{id: 'unified', label: 'Unified'}, {id: 'bridges', label: 'Bridges'}]} selectedOption={selectedTab} onSelect={setSelectedTab} />
                    </div>

                    <div className="space-y-3 overflow-y-auto pb-32 flex-1 pr-2 touch-pan-y no-scrollbar">
                        {selectedTab === 'unified' ? (
                            mockUnified.map(item => (
                                <div key={item.id} className={`relative group p-4 rounded-2xl transition-all duration-300 cursor-pointer
                                    ${item.unread ? 'bg-white/10 border border-white/20 shadow-[0_0_20px_rgba(255,255,255,0.1)]' : 'bg-white/5 border border-white/5 hover:bg-white/10'}
                                `}>
                                    <div className="flex items-start">
                                        <div className={`p-3 rounded-xl bg-black/30 border border-white/10 mr-4 ${item.color} shadow-inner`}>
                                            <item.icon size={20} />
                                        </div>
                                        <div className="flex-1 min-w-0">
                                            <div className="flex justify-between items-center mb-1">
                                                <h3 className={`font-bold text-sm tracking-wide ${item.unread ? 'text-white' : 'text-white/60'}`}>{item.name}</h3>
                                                <span className="text-[10px] text-white/40 font-mono">{item.time}</span>
                                            </div>
                                            <p className={`text-xs truncate ${item.unread ? 'text-white/80' : 'text-white/40'}`}>{item.message}</p>
                                            <div className="mt-2 flex items-center space-x-1.5">
                                                <Globe size={10} className="text-white/30" />
                                                <span className="text-[9px] uppercase tracking-widest text-white/30 font-bold">{item.network}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))
                        ) : (
                            <div className="space-y-3">
                                <div className="px-2 flex justify-between text-[10px] font-bold text-white/30 tracking-widest uppercase">
                                    <span>Network Bridge</span>
                                    <span>Status</span>
                                </div>
                                {mockBridges.map(bridge => (
                                    <div key={bridge.id} className="flex items-center justify-between p-4 bg-white/5 border border-white/5 rounded-2xl">
                                        <div className="flex items-center space-x-3">
                                            <div className="p-2 bg-black/30 rounded-xl border border-white/5">
                                                <Globe size={16} className="text-cyan-400" />
                                            </div>
                                            <div>
                                                <h4 className="text-sm font-bold text-white">{bridge.name}</h4>
                                                <span className="text-[10px] font-mono text-white/40">{bridge.version}</span>
                                            </div>
                                        </div>
                                        <div className="text-right flex flex-col items-end">
                                            <div className="flex items-center space-x-1.5 mb-1">
                                                <span className={`text-[10px] font-bold uppercase ${bridge.status === 'online' ? 'text-green-400' : bridge.status === 'offline' ? 'text-red-400' : 'text-yellow-400'}`}>
                                                    {bridge.status}
                                                </span>
                                                {getStatusIcon(bridge.status)}
                                            </div>
                                            <span className="text-[10px] font-mono text-white/30">{bridge.latency}</span>
                                        </div>
                                    </div>
                                ))}
                                <button className="w-full py-4 mt-4 border border-dashed border-white/20 rounded-2xl text-xs font-bold text-white/40 hover:text-white hover:border-white/40 transition-all uppercase tracking-widest">
                                    + Add New Bridge
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // --- 2. KASM PANEL ---

        const KasmWebviewScreen = () => {
            return (
                <div className="h-full flex flex-col animate-in fade-in duration-500 w-full">
                    <LiquidText className="text-center mb-8">KASM</LiquidText>
                    <LiquidContainer className="flex-1 flex flex-col items-center justify-center mx-4 mb-32">
                        <MonitorSmartphone size={64} className="text-cyan-400 drop-shadow-[0_0_20px_rgba(34,211,238,0.6)] mb-4 animate-pulse" />
                        <p className="text-white/50 font-mono tracking-widest text-xs">REMOTE SESSION ACTIVE</p>
                        <div className="mt-8 w-full px-8">
                            <div className="h-1 w-full bg-white/10 rounded-full overflow-hidden">
                                <div className="h-full bg-cyan-400 w-2/3 animate-pulse shadow-[0_0_10px_rgba(34,211,238,0.8)]" />
                            </div>
                            <div className="flex justify-between mt-2 text-[10px] text-white/30 font-mono">
                                <span>CPU: 12%</span>
                                <span>MEM: 4.2GB</span>
                            </div>
                        </div>
                    </LiquidContainer>
                </div>
            );
        };

        // --- 3. PHONE PANEL ---

        const PhoneScreen = () => {
            const [selectedTab, setSelectedTab] = useState('keypad');
            const [dialerInput, setDialerInput] = useState('');

            const handleDial = (digit) => setDialerInput(prev => prev.length < 12 ? prev + digit : prev);
            const handleCallContact = (number) => {
                setDialerInput(number);
                setSelectedTab('keypad');
            };

            const tabs = [
                { id: 'keypad', label: 'Keypad' },
                { id: 'recents', label: 'Recents' },
                { id: 'contacts', label: 'Contacts' },
            ];

            const recentCalls = [
                { id: 1, name: 'Agent Wren', type: 'incoming', time: '12:45 PM', status: 'answered' },
                { id: 2, name: 'Unknown ID', type: 'missed', time: '10:30 AM', status: 'missed' },
                { id: 3, name: 'Director Vance', type: 'outgoing', time: 'Yesterday', status: 'answered' },
            ];

            const contacts = [
                { id: 1, name: 'Agent Wren', number: '555-0199' },
                { id: 2, name: 'Director Vance', number: '555-0100' },
                { id: 3, name: 'HQ Secure Line', number: '800-555-SEC' },
            ];

            return (
                <div className="h-full flex flex-col animate-in fade-in duration-500 w-full">
                    <LiquidText className="text-center mb-8">COMMS</LiquidText>
                    <div className="mb-6">
                        <SegmentedControl options={tabs} selectedOption={selectedTab} onSelect={setSelectedTab} />
                    </div>

                    <div className="flex-1 flex flex-col overflow-hidden pb-40 px-2 touch-pan-y">
                        {selectedTab === 'keypad' && (
                            <div className="flex-1 flex flex-col justify-end animate-in slide-in-from-bottom-4 fade-in duration-300">
                                <div className="mb-8 px-4 min-h-[4rem] flex items-end justify-center">
                                    <input 
                                        type="text" 
                                        readOnly 
                                        value={dialerInput} 
                                        placeholder="Enter ID"
                                        className="w-full bg-transparent text-center text-4xl text-white font-thin tracking-[0.2em] placeholder-white/10 outline-none drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]"
                                    />
                                </div>
                                <div className="grid grid-cols-3 gap-6 px-6">
                                    {[1,2,3,4,5,6,7,8,9,'*',0,'#'].map(n => (
                                        <div 
                                            key={n} 
                                            onClick={() => handleDial(n)}
                                            className="aspect-square rounded-full bg-white/5 border border-white/10 flex items-center justify-center text-2xl font-light text-white active:bg-white/20 transition-colors cursor-pointer"
                                        >
                                            {n}
                                        </div>
                                    ))}
                                </div>
                                <div className="mt-8 flex justify-center items-center space-x-8">
                                    <button onClick={() => setDialerInput(prev => prev.slice(0, -1))} className="w-12 h-12 flex items-center justify-center text-white/40 hover:text-white"><X size={24}/></button>
                                    <div className="w-20 h-20 rounded-[2rem] bg-white/10 border border-white/20 flex items-center justify-center shadow-[0_0_30px_rgba(255,255,255,0.2)] active:scale-95 transition-transform">
                                        <Phone size={32} className="text-white fill-current" />
                                    </div>
                                    <div className="w-12"/>
                                </div>
                            </div>
                        )}

                        {selectedTab === 'recents' && (
                            <div className="flex-1 overflow-y-auto space-y-2 no-scrollbar">
                                {recentCalls.map(call => (
                                    <div key={call.id} onClick={() => handleCallContact(call.name)} className="flex items-center justify-between p-4 rounded-2xl bg-white/5 border border-white/5 active:bg-white/10 transition-colors">
                                        <div className="flex items-center space-x-4">
                                            <div className={`p-2.5 rounded-xl ${call.status === 'missed' ? 'bg-red-500/20 text-red-300' : 'bg-green-500/20 text-green-300'}`}>
                                                {call.status === 'missed' ? <PhoneMissed size={18}/> : <PhoneIncoming size={18}/>}
                                            </div>
                                            <div>
                                                <h4 className="font-bold text-sm text-white">{call.name}</h4>
                                                <span className="text-[10px] text-white/40 font-mono tracking-wider">{call.time}</span>
                                            </div>
                                        </div>
                                        <ChevronRight size={16} className="text-white/20"/>
                                    </div>
                                ))}
                            </div>
                        )}

                        {selectedTab === 'contacts' && (
                            <div className="flex-1 overflow-y-auto space-y-2 no-scrollbar">
                                {contacts.map(contact => (
                                    <div key={contact.id} onClick={() => handleCallContact(contact.number)} className="flex items-center justify-between p-4 rounded-2xl bg-white/5 border border-white/5 active:bg-white/10 transition-colors">
                                        <div className="flex items-center space-x-4">
                                            <div className="w-10 h-10 rounded-xl bg-gradient-to-br from-white/10 to-white/5 border border-white/10 flex items-center justify-center text-white font-bold">
                                                {contact.name.charAt(0)}
                                            </div>
                                            <div>
                                                <h4 className="font-bold text-sm text-white">{contact.name}</h4>
                                                <span className="text-[10px] text-white/40 font-mono tracking-wider">{contact.number}</span>
                                            </div>
                                        </div>
                                        <Phone size={16} className="text-white/30"/>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // --- SETTINGS MODAL ---

        const SettingsModal = ({ isOpen, onClose }) => {
            if (!isOpen) return null;

            return (
                <div className="absolute inset-0 z-50 flex items-center justify-center p-6 bg-black/60 backdrop-blur-xl animate-in zoom-in-95 duration-300">
                    <LiquidContainer className="w-full max-w-sm p-8 bg-black/40">
                        <button onClick={onClose} className="absolute top-6 right-6 text-white/40 hover:text-white transition-colors">
                            <X size={24} />
                        </button>
                        
                        <LiquidText className="text-xl mb-10 text-center">SENSITIVITY</LiquidText>
                        
                        <div className="space-y-10">
                            <div className="space-y-3">
                                <div className="flex justify-between text-[10px] font-bold text-white/50 tracking-[0.2em]">
                                    <span>GESTURE</span>
                                    <span>EDGE AREA</span>
                                </div>
                                <input type="range" className="w-full h-1.5 bg-white/10 rounded-full appearance-none cursor-pointer accent-white hover:accent-cyan-200" />
                            </div>
                            
                            <div className="space-y-3">
                                <div className="flex justify-between text-[10px] font-bold text-white/50 tracking-[0.2em]">
                                    <span>EDGE ZONES</span>
                                    <span>MAX</span>
                                </div>
                                <input type="range" className="w-full h-1.5 bg-white/10 rounded-full appearance-none cursor-pointer accent-white hover:accent-cyan-200" />
                            </div>

                            <div className="flex items-center justify-between pt-6 border-t border-white/10">
                                <span className="text-[10px] font-bold text-white/50 tracking-[0.2em]">HAPTIC FEEDBACK</span>
                                <div className="flex items-center space-x-3">
                                    <span className="text-sm font-bold text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.8)]">ON</span>
                                    <div className="w-2 h-2 rounded-full bg-cyan-400 shadow-[0_0_8px_rgba(34,211,238,0.8)] animate-pulse" />
                                </div>
                            </div>
                        </div>
                    </LiquidContainer>
                </div>
            );
        };

        // --- CONTROL CENTER ---

        const ControlCenter = ({ isOpen, dragY }) => {
            const style = isOpen 
                ? { transform: 'translateY(0)' } 
                : dragY !== null 
                    ? { transform: `translateY(${dragY - window.innerHeight}px)`, transition: 'none' } 
                    : { transform: 'translateY(-100%)' };

            return (
                <div className="fixed inset-0 z-40 bg-black/60 backdrop-blur-md transition-transform duration-500 cubic-bezier(0.32, 0.72, 0, 1)" style={style}>
                    <div className="absolute inset-x-4 top-4 bottom-24 bg-[#0a0a0a]/90 backdrop-blur-3xl rounded-[2.5rem] border border-white/10 p-6 shadow-2xl overflow-hidden flex flex-col">
                        <div className="flex justify-between items-center mb-8 px-2">
                            <div className="flex flex-col">
                                <h2 className="text-3xl font-thin text-white">12:00</h2>
                                <span className="text-xs text-white/50 font-bold tracking-widest uppercase">System Control</span>
                            </div>
                            <Settings className="text-white/50" />
                        </div>
                        <div className="grid grid-cols-2 gap-4 mb-6">
                            <div className="bg-white/5 rounded-2xl p-4 border border-white/5 flex flex-col justify-between h-32 active:bg-white/10">
                                <div className="p-2 bg-cyan-500/20 rounded-full w-fit text-cyan-400"><Wifi size={20} /></div>
                                <span className="text-sm text-white font-semibold">Selfown_5G</span>
                            </div>
                            <div className="bg-white/5 rounded-2xl p-4 border border-white/5 flex flex-col justify-between h-32 active:bg-white/10">
                                <div className="p-2 bg-blue-500/20 rounded-full w-fit text-blue-400"><Bluetooth size={20} /></div>
                                <span className="text-sm text-white font-semibold">Connected</span>
                            </div>
                        </div>
                        <div className="space-y-4 mb-8">
                            <div className="bg-white/5 rounded-2xl p-4 flex items-center space-x-4">
                                <SunDim size={20} className="text-white/50" />
                                <div className="flex-1 h-10 bg-black/30 rounded-full overflow-hidden relative">
                                    <div className="absolute inset-y-0 left-0 w-[70%] bg-white/20 backdrop-blur-md" />
                                </div>
                            </div>
                            <div className="bg-white/5 rounded-2xl p-4 flex items-center space-x-4">
                                <Volume2 size={20} className="text-white/50" />
                                <div className="flex-1 h-10 bg-black/30 rounded-full overflow-hidden relative">
                                    <div className="absolute inset-y-0 left-0 w-[45%] bg-white/20 backdrop-blur-md" />
                                </div>
                            </div>
                        </div>
                        <div className="absolute bottom-4 left-1/2 -translate-x-1/2 w-12 h-1 bg-white/20 rounded-full" />
                    </div>
                </div>
            );
        };


        // --- HALO NAVIGATION (ARC HUD) ---

        const HaloNavigation = ({ onLaunchApp }) => {
            const [active, setActive] = useState(false);
            const [hoveredIndex, setHoveredIndex] = useState(null);
            const buttonRef = useRef(null);
            
            // Apps for the arc
            const apps = [
                { id: 'beeper', label: '01 BEEPER', icon: MessageSquare, color: 'text-cyan-400' },
                { id: 'kasm', label: '02 KASM', icon: MonitorSmartphone, color: 'text-purple-400' },
                { id: 'phone', label: '03 COMMS', icon: Phone, color: 'text-green-400' },
                { id: 'settings', label: '04 CONFIG', icon: Sliders, color: 'text-gray-300' },
                { id: 'files', label: '05 DATA', icon: Folder, color: 'text-yellow-400' },
            ];

            const handleTouchStart = (e) => {
                e.stopPropagation(); 
                setActive(true);
            };

            const handleTouchMove = (e) => {
                if (!active) return;
                e.stopPropagation();
                
                const touchX = e.touches[0].clientX;
                const touchY = e.touches[0].clientY;
                const btnRect = buttonRef.current.getBoundingClientRect();
                const centerX = btnRect.left + btnRect.width / 2;
                const centerY = btnRect.top + btnRect.height / 2;
                const dx = touchX - centerX;
                const dy = touchY - centerY;
                let angle = Math.atan2(dy, dx) * (180 / Math.PI);
                const dist = Math.sqrt(dx*dx + dy*dy);
                
                if (dist > 60 && angle < 0 && angle > -180) {
                    let arcAngle = angle + 180; 
                    const startArc = 10; 
                    const endArc = 170;
                    
                    if (arcAngle >= startArc && arcAngle <= endArc) {
                        const totalArc = endArc - startArc;
                        const sectorSize = totalArc / apps.length;
                        const index = Math.floor((arcAngle - startArc) / sectorSize);
                        setHoveredIndex(Math.min(Math.max(index, 0), apps.length - 1));
                    } else {
                        setHoveredIndex(null);
                    }
                } else {
                    setHoveredIndex(null);
                }
            };

            const handleTouchEnd = (e) => {
                e.stopPropagation();
                if (active && hoveredIndex !== null && apps[hoveredIndex]) {
                    onLaunchApp(apps[hoveredIndex]);
                }
                setActive(false);
                setHoveredIndex(null);
            };

            return (
                <>
                    {active && (
                        <div 
                            className="fixed inset-0 z-[60] touch-none select-none"
                            onTouchMove={handleTouchMove}
                            onTouchEnd={handleTouchEnd}
                        >
                            <div className="absolute inset-0 bg-black/80 backdrop-blur-md animate-in fade-in duration-200" />
                            
                            <div className="absolute bottom-12 left-1/2 w-0 h-0">
                                {/* Glowing Tracks */}
                                <div className="absolute -left-[180px] -top-[180px] w-[360px] h-[360px] rounded-full border border-white/10 border-t-cyan-500/50 opacity-70" />
                                <div className="absolute -left-[130px] -top-[130px] w-[260px] h-[260px] rounded-full border border-white/5" />

                                {apps.map((app, i) => {
                                    const totalSpread = 160; 
                                    const startAngle = -170;
                                    const angleStep = totalSpread / (apps.length - 1);
                                    const angleDeg = startAngle + (i * angleStep);
                                    const radius = 155; 
                                    const x = radius * Math.cos(angleDeg * (Math.PI / 180));
                                    const y = radius * Math.sin(angleDeg * (Math.PI / 180));
                                    const isHovered = hoveredIndex === i;
                                    const rotation = angleDeg + 90;

                                    return (
                                        <React.Fragment key={app.id}>
                                            <div 
                                                className="absolute flex flex-col items-center justify-center w-0 h-0 transition-all duration-300"
                                                style={{ transform: `translate(${x}px, ${y}px)` }}
                                            >
                                                <div 
                                                    className={`absolute -top-8 text-[10px] font-bold tracking-[0.2em] uppercase whitespace-nowrap transition-all duration-200 ${isHovered ? 'text-cyan-400 scale-110 drop-shadow-[0_0_8px_rgba(34,211,238,0.8)]' : 'text-white/30'}`}
                                                    style={{ transform: `rotate(${rotation}deg)` }}
                                                >
                                                    {app.label}
                                                </div>
                                                <div className={`w-2 h-2 rounded-full transition-all duration-200 ${isHovered ? 'bg-cyan-400 shadow-[0_0_10px_rgba(34,211,238,1)] scale-150' : 'bg-white/20'}`}/>
                                            </div>
                                        </React.Fragment>
                                    );
                                })}
                                <div className="absolute -top-24 left-0 -translate-x-1/2 -translate-y-1/2">
                                    <Heart size={16} className="text-red-500/80 fill-red-500/20 animate-pulse drop-shadow-[0_0_10px_rgba(239,68,68,0.5)]" />
                                </div>
                            </div>
                        </div>
                    )}

                    <div 
                        ref={buttonRef}
                        className={`fixed bottom-8 left-1/2 -translate-x-1/2 z-[50] transition-all duration-300 ${active ? 'scale-125 opacity-0' : 'scale-100 opacity-100'}`}
                        onTouchStart={handleTouchStart}
                    >
                        <div className="w-16 h-16 rounded-full flex items-center justify-center bg-white/5 border border-white/10 hover:bg-white/10 shadow-lg backdrop-blur-md cursor-pointer relative group">
                            <div className="absolute inset-0 rounded-full bg-cyan-500/20 blur-xl animate-pulse opacity-50 group-hover:opacity-100 transition-opacity" />
                            <div className="absolute inset-0 rounded-full border border-cyan-500/30 animate-ping opacity-20 pointer-events-none"></div>
                            <Fingerprint size={32} className="text-cyan-400/80 relative z-10" />
                        </div>
                    </div>
                </>
            );
        };

        // --- MAIN APP COMPONENT ---

        const App = () => {
            const [currentScreen, setCurrentScreen] = useState('beeper'); 
            const [loading, setLoading] = useState(false); // Fail-safe disabled loading
            const [controlCenterOpen, setControlCenterOpen] = useState(false);
            const [controlCenterDragY, setControlCenterDragY] = useState(null);
            const [showSettings, setShowSettings] = useState(false);

            const mainRef = useRef(null);
            const touchStart = useRef({ x: 0, y: 0 });
            const isDragging = useRef(false);
            const dragType = useRef(null);

            // Fail-safe default
            const [containerWidth, setContainerWidth] = useState(window.innerWidth || 0); 
            const [currentHorizontalPosition, setCurrentHorizontalPosition] = useState(0);

            useEffect(() => {
                const init = () => {
                    const w = window.innerWidth;
                    setContainerWidth(w);
                    setCurrentHorizontalPosition(0);
                };
                init();
                window.addEventListener('resize', init);
                return () => window.removeEventListener('resize', init);
            }, []);

            const screenOrder = ['beeper', 'kasm', 'phone'];

            const handleAppLaunch = (app) => {
                if (screenOrder.includes(app.id)) {
                    setCurrentScreen(app.id);
                } else {
                    if (app.id === 'settings') setShowSettings(true);
                    else console.log("Launch:", app.label);
                }
            };

            // Sync carousel position with currentScreen
            useEffect(() => {
                const idx = screenOrder.indexOf(currentScreen);
                // Use VW unit equivalent logic or standard px logic if available
                // To be fail-safe, we can use percentage in style prop if containerWidth is 0?
                // But containerWidth is initialized to window.innerWidth.
                if (containerWidth > 0) {
                    setCurrentHorizontalPosition(-idx * containerWidth);
                }
            }, [currentScreen, containerWidth]);

            // --- TOUCH HANDLERS ---

            const handleTouchStart = (e) => {
                if (showSettings) return;
                const x = e.touches[0].clientX;
                const y = e.touches[0].clientY;
                touchStart.current = { x, y };
                isDragging.current = true;
                dragType.current = null;
                setControlCenterDragY(null);
            };

            const handleTouchMove = (e) => {
                if (!isDragging.current) return;
                
                const x = e.touches[0].clientX;
                const y = e.touches[0].clientY;
                const dx = x - touchStart.current.x;
                const dy = y - touchStart.current.y;

                if (!dragType.current) {
                    if (touchStart.current.y < 100 && touchStart.current.x < (window.innerWidth / 2) && dy > 10) {
                        dragType.current = 'controlCenter';
                    } else if (Math.abs(dx) > 20 && Math.abs(dx) > Math.abs(dy)) {
                        dragType.current = 'carousel';
                    }
                }

                if (dragType.current === 'controlCenter') {
                    setControlCenterDragY(y); 
                    if (e.cancelable) e.preventDefault(); 
                }
            };

            const handleTouchEnd = (e) => {
                if (!isDragging.current) return;
                const x = e.changedTouches[0].clientX;
                const y = e.changedTouches[0].clientY;
                const dx = x - touchStart.current.x;
                const dy = y - touchStart.current.y;

                if (dragType.current === 'controlCenter') {
                    const threshold = window.innerHeight * 0.25;
                    setControlCenterOpen(dy > threshold);
                    setControlCenterDragY(null);
                } else if (dragType.current === 'carousel') {
                    const currentIndex = screenOrder.indexOf(currentScreen);
                    const threshold = 50;
                    
                    if (dx < -threshold && currentIndex < screenOrder.length - 1) {
                        setCurrentScreen(screenOrder[currentIndex + 1]);
                    } else if (dx > threshold && currentIndex > 0) {
                        setCurrentScreen(screenOrder[currentIndex - 1]);
                    }
                } else if (controlCenterOpen && dy < -50) {
                    setControlCenterOpen(false);
                }

                isDragging.current = false;
                dragType.current = null;
            };

            // Live Clock & Battery
            const [time, setTime] = useState(new Date());
            const [battery, setBattery] = useState({ level: 100, charging: false });

            useEffect(() => {
                const t = setInterval(() => setTime(new Date()), 60000);
                if (typeof navigator !== 'undefined' && navigator.getBattery) {
                    navigator.getBattery().then(b => {
                        setBattery({ level: Math.round(b.level * 100), charging: b.charging });
                    });
                }
                return () => clearInterval(t);
            }, []);

            return (
                <div 
                    className="h-screen w-screen overflow-hidden bg-black text-white font-sans select-none relative"
                    onTouchStart={handleTouchStart}
                    onTouchMove={handleTouchMove}
                    onTouchEnd={handleTouchEnd}
                >
                    <div className="absolute inset-0 bg-gradient-to-br from-indigo-900/20 via-black to-cyan-900/20 pointer-events-none" />
                    <div className="absolute top-[-20%] left-[-20%] w-[70vw] h-[70vw] bg-purple-500/10 rounded-full blur-[100px] pointer-events-none animate-pulse" />
                    
                    {/* STATUS BAR */}
                    <div className="fixed top-0 w-full z-30 p-4 flex justify-between text-xs font-bold tracking-widest text-white/40 pointer-events-none">
                        <div className="flex items-center"><Clock size={12} className="mr-1.5 text-white/60"/> 12:00 PM</div>
                        <div className="text-white/80 drop-shadow-[0_0_10px_rgba(255,255,255,0.3)]">SELFOWN_</div>
                        <div className="flex items-center"><Wifi size={12} className="mr-1.5 text-white/60"/> 5G</div>
                    </div>

                    <ControlCenter isOpen={controlCenterOpen} dragY={controlCenterDragY} />
                    <SettingsModal isOpen={showSettings} onClose={() => setShowSettings(false)} />

                    {/* CAROUSEL - USING CSS FOR FAILSAFE WIDTH */}
                    <main 
                        ref={mainRef}
                        className="absolute inset-0 flex transition-transform duration-500 cubic-bezier(0.2, 0.8, 0.2, 1)"
                        style={{ width: '300vw', transform: `translateX(-${screenOrder.indexOf(currentScreen) * 100}vw)` }}
                    >
                        <div style={{ width: '100vw' }} className="h-full pt-16 pb-24 px-4 overflow-hidden"><BeeperScreen /></div>
                        <div style={{ width: '100vw' }} className="h-full pt-16 pb-24 px-4 overflow-hidden"><KasmWebviewScreen /></div>
                        <div style={{ width: '100vw' }} className="h-full pt-16 pb-24 px-4 overflow-hidden"><PhoneScreen /></div>
                    </main>

                    {/* HALO NAV */}
                    <HaloNavigation onLaunchApp={handleAppLaunch} />

                    {/* PAGE DOTS */}
                    <div className="fixed bottom-28 left-1/2 -translate-x-1/2 flex space-x-2 pointer-events-none">
                        {screenOrder.map(screen => (
                            <div key={screen} className={`w-1.5 h-1.5 rounded-full transition-all duration-300 ${currentScreen === screen ? 'bg-cyan-400 w-4' : 'bg-white/20'}`} />
                        ))}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>